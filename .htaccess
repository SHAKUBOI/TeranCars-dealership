Options -Indexes

# Activation PHP dans le cas où l'interpréteur ne fonctionnerait pas automatiquement
AddType application/x-httpd-php .php

# Activation du module de réécriture d'URL
RewriteEngine On

# Définition de la base de l'URL
RewriteBase /DaCar/

# Permettre l'accès direct aux fichiers et dossiers existants
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Redirection de la page d'accueil
RewriteRule ^$ index.php [L,QSA]

# Redirection des fichiers statiques dans public
RewriteRule ^(assets|images|js|css)/(.*)$ public/$1/$2 [L]

# Redirection des pages d'authentification
RewriteRule ^auth/([^/]+)$ public/pages/auth/$1.php [L,QSA]

# Redirection des pages de détail des véhicules
RewriteRule ^vehicule/detail$ public/pages/vehicule/detail.php [L,QSA]

# Redirection des autres pages
RewriteRule ^([^/]+)/?$ public/pages/$1/index.php [L,QSA]

# Protection des fichiers sensibles
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Pages d'erreur personnalisées
ErrorDocument 404 /DaCar/public/pages/errors/404.php
ErrorDocument 403 /DaCar/public/pages/errors/403.php

# Forcer HTTPS (à décommenter en production)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirection de toutes les requêtes vers le dossier public
RewriteCond %{REQUEST_URI} !^/public/
RewriteRule ^(.*)$ public/$1 [L]

# Si le fichier demandé n'existe pas, rediriger vers index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L] 